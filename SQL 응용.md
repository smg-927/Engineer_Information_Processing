## 74. SQL(Structured Query Language)
### SQL
- 관계형 데이터베이스를 제어하는 DBMS의 표준 언어로 관계 대수를 기초로 만들어졌다.
- DDL, DML, DCL로 구성
- 내장 SQL : 프로그래밍 언어에서 관계형 데이터베이스를제어하기위해 통합된 SQL
### SQL 명령어의 분류
- DDL
	- CREATE : 생성
	- ALTER :수정
	- DROP : 제거
	- TRUNCATE : 데이터 전체 삭제
- DML
	- INSERT : 삽입
	- UPDATE : 갱신
	- DELETE : 삭제
	- SELECT : 조회
- DCL
	- GRANT : 사용자 권한 부여
	- REVOKE : 권한 회수
	- COMMIT : 트랜젝션 결과 반영
	- ROLLBACK : 작업 취소
	- CHECKPOINT : 트랜젝션 복귀지점 설정
---
## 75. 관계 대수
### 관계 해석
- 원하는 정보가 무엇 인지 정의하는 비절차적 언어
- 논리 기호
	- OR(v)
	- AND(^)
	- NOT (_)
- 관계 해석 정량자
	- 전칭 정량자 : 모든 것에 대하여
	- 존재 정량자 : 어느 것 하나라도 존재
### 관계 대수
- 원하는 정보와 그 정보를 어떻게 유도하는가를 정의하는 절차적 언어
- 일반 집합 연산자
	- 합집합 : 튜플의 중복 없이 합하기
	- 교집합 : 중복 튜플 추출
	- 차 집합 : 중복 부분 제외 추출
	- 교차 곱 : 튜플을 합지고 순서쌍의 집합을 만드는 연산
- 순수 관계 연산자
	- SELECT : 조건에 맞는 튜플 추출
	- PROJECT : 지정된 속성만을 추출하여 수직적 부분 집합을 구함
	- JOIN : 두 릴레이션에서 조건에 맞는 튜플을 하나로 합진 릴레이션 구함
	- DIVISION : 대상 릴레이션에서 다른 릴레이션 속성의 데이터와 일치하는 튜플 중 다른 릴레이션의 속성과 일치하는 속성을 제거한 릴레이션을 생성하는 연산
### 쿼리 최적화 규칙
- 쿼리 최적화의 기준 : 데이터 모델은 설계 및 운용 방식에 따라 다양하기 구성되므로 적대적인 최적화 규칙은 존재하지 않는다.
- 일반적인 규칙 : 원하지 않는 데이터가 가장 많이 제거되는 추출 연산을 일찍 수행
- 선택 연산 최대한 일찍 수행
- 조인 연산은 마지막에 수행
---
## 76. DDL
### CREATE
- 데이터베이스 객체 생성
	- CREATE 객체유형 객체명 옵션;
- 테이블 생성 옵션
	- INT
	- DOUBLE
	- CHAR(N)
	- VARCHAR(N)
	- DATE
	- UNIQUE : 유일키 정의
	- NOT NULL :공백 허용 x
	- CHECK : 컬럼에 허용되는 값을 제한
- 각 테이블에 지정 가능한 제약조건의 예
	- PRIMARY KEY 컬럼명 : 기본키 UNIQUE + NOT NULL 정의
	- FOREIGN KEY 컬럼명 REFERENCES 컬럼명 : 외래키 정의
	- ON UPDATE 처리옵션 : 데이터 갱신 시 처리 옵션에 따라 작업 수행
	- ON DELETE 처리옵션 : 데이터 삭제 시 처리 옵션에 따라 작업 수행
- 데이터 갱신 및 삭제의 처리 옵션
	- NO ACTION : 무시
	- SET DEFAULT : 관련 튜플 모두 기본값 지정
	- SET NULL : 관련 튜플을 NULL값으로 수정
	- CASCADE 관련된 튜플 모두 함께 처리
	- RESTRICT : 관련된 튜플 없는 경우에만 처리
- 테이블 구조 복사
	- CREATE TABLE 테이블명 AS SELECT문
---
## 77. 데이터 조작어
- INSERT
	- INSERT INTO 테이블명 VALUES 값......
	- INSERT INTO 테이블명 컬럼명 VALUES 값...
	- INSERT INTO 테이블명 필드 SELECT문
- UPDATE : 지정한 조건을 만족하는 레코드들의 해당 컬럼의 필드값을 갱신한다.
	- UPDATE 테이블명 SET 컬럼명=값//// WHERE 조건식
- DELETE : 지정한 조건을 만족하는 레코드를 삭제한다.
	- DELETE FROM 테이블명 WHERE 조건식
- SELECT : 지정한 형식과 조건에 대응되는 결과를 릴레이션에 출력
---
## 78. SELECT 활용
### AS
- 집계함수와 AS
	- COUNT() : 레코드 개수
	- SUM()/AVG() : 합계/평균
	- MAX()/MIN() : 최대값/최소값
	- STDDEV() : 표준편차
	- VARIANCE() : 분산
	- SELECT SUM(점수) FROM 학생정보;
- 윈도우 함수 : 온라인 분석 처리 용도로 사용하기 위해 추가된 기능
	- 집계 함수 : SQL 집계 함수와 동일
	- 순위 함수 : 레코드의 순위 계산
		- RANK : 동일 레코드 순위만큼 다음 순위 건너뜀
		- DENSE_RANK : 동일 레코드를 하나의 순위로 구분
		- ROW_NUMBER : 동일 레코드라도 순차적 순위로 구분
	- 행 순서 함수 : 레코드에서 가장 먼저 나오거나 가장 나중에 나오는 값.
		- FIRST_VALUE : 최소값
		- LAST_VALUE : 최대값
		- LAG : 특정 레코드의 이전 N번째 행의 값
		- LEAD : 특정 레코드의 이후 N번째 행의 값
	- 그룹 내 비율 함수 : 주어진 그룹에 대해 비율과 관련된 통계
		- RATIO_TO_REPORT : 합을 기준으로 각 행의 상대적 비율 반환
		- PERCENT_RANK : 가장 먼저 나오는 것을 0으로. 가장 나중에 나오는 것을 1로 하여 행의 순서별 백분율 반환
### 조건식
- AND
- OR
- IS NULL
- LIKE : 특정 문자 패턴을 가지는 문자열을 검색해야 하는 경우에 사용한다.
	- SELECT * FROM 성적 WHERE 이름 LIKE 패턴
	- LIKE %A : A로 끝나는 문자열 패턴
	- LIKE A% : A로 시작하는 문자열 패턴
	- LIKE %A% : A를 포함하는 문자열 패턴
	- LIKE A_ : A로 시작하는 2글자 문자열 패턴
	- LIKE $_$A$_$ : A가 가운데 가는 3글짜 문자열 패턴
### 하위 질의
- 정의 : 메인 쿼리에 포함된 또 하나의 쿼리
- SELECT * FROM 성적 WHERE 학과 = (SELECT 학과 FROM 성적 WHERE 이름 = '권영석');
### 정렬과 그룹
- 단일 정렬 
	- ASC : 오름차순
	- DESC : 내림차순
- 다중 정렬 : 정렬된 레코드를 또 다른 기준으로 다시 정렬
	- SELECT * FROM 성적 ORDER BY 성별 ASC, 반 DESC
- 그룹과 요약
	- ROLLUP() : 지정된 컬럼 중 첫 컬럼의 각 그룹의 합계와 전체 합계
	- CUBE() : 지정된 모든 컬럼의 각 그룹의 합계와 전체 합계
	- GROUPING SETS() : 각 그룹별 총 합계만 표시
	- GROUPING() : 집계 함수를 지원하는 함수
### 조인
- INTER JOIN : 두 테이블의 기준 필드가 일치하는 레코드만 조인
- OUTER JOIN : 두 테이블의 기준 필드가 일치하지 않는 모든 레코드도 함께 조인
- LEFT JOIN : 왼쪽 테이블 레코드는 전부 포함, 오른쪽 테이블은 일치하는 것만 조인
- RIGHT JOIN : 오른쪽 테이블 레코드는 전부 포함, 왼쪽 테이블은 일치하는 것만 조인
---
## 79. DCL
### 권한 제어
- GRANT : 특정 사용자 및 그룹에게 특정 권한 부여
	- WITH GRAND OPTION : 부여받은 권한을 다른 사용자에게 부여, 회수 가능
	- WITH ADMIN OPTION : 부여받은 권한을 다른 사용자에게 부여만 가능
- REVOKE : 권한 회수
	- REVOKE 권한 유형 FROM 대상;
- ROLE
	- 사용자에게 허가 가능한 권한들의 집합 또는 같은 권한을 부여받는 사용자 그룹을 뜻한다.
	- CREATE ROLE 역할명
	- GRANT 권한 TO 역할명
	- GRANT 역할명 TO 사용자
### 트랜잭션 제어
- 데이터베이스를 조작하는 논리적 연산들이 하나 이상 모인 단위 작업
- Commit : 트랜잭션에 의한 변경 사항을 최종 반영
- Rollback : 트랜잭션에 의한 변경 사항을 이전 상황으로 복구
- Savepoint : 트랜잭션의 규모가 너무 크거나 복잡한 경우에 Rollback 지점을 별도로 지정
- 특징 
	- 원자성
	- 일관성
	- 고립성
	- 지속성
- 상태 제어
	- 활동
	- 부분 완료
	- 완료
	- 실패
	- 철회
	- 실행 취소
	- 다시 실행
---
## 80. 절차형 SQL
### 절차형 SQL
- 순차적인 SQL문의 실행, 분기, 반복을 활용하여 다양한 기능을 수행하는 모듈
- DECLARE, BEGIN, END가 필수 구성 요소이다.
	- DECLARE : 절차형 SQL의 명칭, 변수, 인수, 타입 등을 정의하는 영역
	- BEGIN~END : 실제 구현 영역
- 특징
	- DBMS 내부에서 직접 실행되며 사용 난이도가 쉬움
### 프로시저
- 호출을 통해 실행되는 절차형 SQL이다.
- DML위주로 구성되며 주기적으로 반복되는 작업에 사용
- 구성 요소
	- CONTROL : 순차, 분기, 반복 처리 영역
	- EXCEPTION : 예외 발생 시 예외 처리 방법 정의 영역
	- SQL : 주로 DML을 사용하여 데이터 처리
	- TRANSACTION : SQL 수행 내역의 반영, 취소, 처리 영역
### 사용자 정의 함수
- 호출을 통해 실행되는 절차형 SQL이다.
- 구성요소
	- CONTROL : 순차, 분기, 반복  처리
	- EXCEPTION : 예외 발생 시 예외 처리 방법 정의
	- SQL : 주로 DML을 사용하여 데이터 처리
	- RETURN : 호출 위치에 반환할 값이나 변수 정의
### 트리거
- 데이터베이스의 이벤트 발생에 의해 자동으로 호출되는 절차형 SQL
- 구성요소
	- EVENT : 트리거가 실행되는 조건(필수)
	- CONTROL : 순차, 분기, 반복 처리 영역
	- EXCEPTION : 예외 발생 시 예외 처리 방법 정의 영역
	- SQL : 주로 DML을 사용하여 데이터 처리
	- 기타 옵션
		- AFTER : 테이블이 변경된 후 실행
		- BEFORE : 테이블이 변경되기 전 실행
		- FOR EACH NOW : 트리거 적용 대상을 테이블에서 '레코드마다' 로 변경
		- NEW : 새롭게 반영될 데이터
		- OLD : 기존 데이터
---
## 인덱스와 뷰
### 인덱스
- 저장된 데이터를 빠르게 검색할 수 있도록 구성된 자료구조 및 방법
- 구현
	- 인덱스 생성 : CREATE UNIQUE INDEX 인덱스명 ON 테이블명 컬럼명 .....
	- 인덱스 삭제
	- 인덱스 변경, 조회 등등
### 뷰
- 하나 이상의 테이블로부터 유도되는 논리적인 가상 테이블
- 장점 
	- 데이터의 논리적인 독립성을 유지하며 원본의 데이블 구조 변경에 영향을 최소화 가능
	- 여러 테이블에 존재하는 데이터에 접근하는 방법을 단순화, 다양화 가능
	- 테이블의 일부 데이터에 대해서만 접근을 허용하는 방식으로 보안 유지
- 단점
	- 물리적인 실제 데이터가 없기 때문에 자체 인덱스 사용이 불가능하고 내용을 수정하는 것도 많은 제약이 따름
	- 뷰를 변경하기 위해서는 삭제한 뒤 다시 생성해야함
- 구현
	- REPLACE
	- FORCE
	- NOFORCE
	- WITH CHECK OPTION
	- WITH READ ONLY
---
## 82. SQL 지원 도구
### 시스템 카탈로그
- 데이터베이스 객체들에 대한 정의와 명세를 메타 데이터 형태로 유지관리하는 시스템 테이블
- 데이터 사전이라고도 함.
- 구성 요소
	- 시스템 카탈로그 : 데이터 사전과 같은 의미
	- 데이터 디렉토리 : DBMS에 의해서만 접근 가능한 데이터 사전 접근 정보
	- 메타 데이터 : 다른 데이터를 설명하기 위한 데이터
- 특징 : DBMS가 스스로 생성하고 유지하며 접근 가능, 직접 변경 불가능

### SQL 지원 도구
- PL/SQL 
	- 프로그래밍 언어의 특성을 통합한 확장 SQL기능
- SQL$*$PLUS
	- Oracle사에서 제공하는 SQL지원 도구
- APM
	- 안정적인 시스템 운영을 위한 모니터링 도구
- TKPROF
	- 실행되는 SQL 문장을 추적, 분석하여 지침을 제공해준다.
- EXPLAIN PLAN
	- SQL 문장의 경로를 분석하여 성능 개선 지침을 제공해준다.
- 소스 코드 인스펙션 도구
	- 데이터베이스를 조작하는 프로시저 코드등을 분석하여 성능의 문제점을 개선함으로써 데이터베이스의 성능을 향상시키는 도구이다.
---
## 병행 제어와 로킹
### 병행 제어
- 데이터베이스의 활용도를 최대화하기 위해 여러 사용자들의 데이터베이스 공동 사용을 최대화하는 기술이다.
- 문제점
	- 분실된 갱신 : 데이터를 두개의 트랜잭션이 갱신되면서 누락
	- 모순성 : 데이터를 두 개의 트랜잭션이 갱신하면서 문제가 발생하면서 원하지 않는 결과가 됨
	- 연쇄 복귀 : 데이터를 두개의 트랜잭션이 갱신하면서 문제가 발생하면 모두 갱신 전으로 복귀
	- 비완료 의존성 : 하나의 트랜잭션이 실패하고 회복이 이뤄지기 전에 다른 트랜잭션이 실패한 수행 결과를 참조하는 경우
### ==로킹==
- 트랜잭션이 갱신중인 데이터를 다른 트랜잭션이 접복